var dt=function(){function t(t){this.root=u({trainingSet:t.trainingSet,ignoredAttributes:n(t.ignoredAttributes),categoryAttr:t.categoryAttr||"category",minItemsCount:t.minItemsCount||1,entropyThrehold:t.entropyThrehold||.01,maxTreeDepth:t.maxTreeDepth||70})}function r(t,r){this.trees=h(t,r)}function n(t){var r={}
if(t)for(var n in t){var e=t[n]
r[e]=!0}return r}function e(t,r){for(var n={},e=t.length-1;e>=0;e--)n[t[e][r]]=0
for(var e=t.length-1;e>=0;e--)n[t[e][r]]+=1
return n}function a(t,r){var n,a=e(t,r),i=0
for(var o in a)n=a[o]/t.length,i+=-n*Math.log(n)
return i}function i(t,r,n,e){for(var a,i,o=[],u=[],c=t.length-1;c>=0;c--)a=t[c],i=a[r],n(i,e)?o.push(a):u.push(a)
return{match:o,notMatch:u}}function o(t,r){var n,a=e(t,r),i=0
for(var o in a)a[o]>i&&(i=a[o],n=o)
return n}function u(t){var r=t.trainingSet,n=t.minItemsCount,e=t.categoryAttr,c=t.entropyThrehold,h=t.maxTreeDepth,f=t.ignoredAttributes
if(0==h||r.length<=n)return{category:o(r,e)}
var v=a(r,e)
if(v<=c)return{category:o(r,e)}
for(var p={},m={gain:0},d=r.length-1;d>=0;d--){var s=r[d]
for(var l in s)if(l!=e&&!f[l]){var y,M=s[l]
y="number"==typeof M?">=":"=="
var b=l+y+M
if(!p[b]){p[b]=!0
var T=g[y],S=i(r,l,T,M),A=a(S.match,e),C=a(S.notMatch,e),D=0
D+=A*S.match.length,D+=C*S.notMatch.length,D/=r.length
var x=v-D
x>m.gain&&(m=S,m.predicateName=y,m.predicate=T,m.attribute=l,m.pivot=M,m.gain=x)}}}if(!m.gain)return{category:o(r,e)}
t.maxTreeDepth=h-1,t.trainingSet=m.match
var N=u(t)
t.trainingSet=m.notMatch
var I=u(t)
return{attribute:m.attribute,predicate:m.predicate,predicateName:m.predicateName,pivot:m.pivot,match:N,notMatch:I,matchedCount:m.match.length,notMatchedCount:m.notMatch.length}}function c(t,r){for(var n,e,a,i;;){if(t.category)return t.category
n=t.attribute,e=r[n]
a={"==":function(t,r){return t==r},">=":function(t,r){return t>=r},"!=":function(t,r){return t!=r},"<=":function(t,r){return t<=r}}[t.predicateName],i=t.pivot,t=a(e,i)?t.match:t.notMatch}}function h(r,n){for(var e=r.trainingSet,a=[],i=0;i<n;i++)a[i]=[]
for(var o=e.length-1;o>=0;o--){a[o%n].push(e[o])}for(var u=[],i=0;i<n;i++){r.trainingSet=a[i]
var c=new t(r)
u.push(c)}return u}function f(t,r){var n={}
for(var e in t){var a=t[e],i=a.predict(r)
n[i]=n[i]?n[i]+1:1}return n}t.prototype.predict=function(t){return c(this.root,t)},r.prototype.predict=function(t){return f(this.trees,t)}
var g={"==":function(t,r){return t==r},">=":function(t,r){return t>=r},"!=":function(t,r){return t!=r},"<=":function(t,r){return t<=r}},v={}
return v.DecisionTree=t,v.RandomForest=r,v}()
